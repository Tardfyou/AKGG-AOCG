# AKGG-AOCG
Automatic knowledge graph query and automatic orchestration script generation.
Knowledge Graph-Based Automated Script Generation with W5 Orchestration

This project provides a complete solution for automatic script generation based on a knowledge graph and W5 automation orchestration.

## Project Structure

The project consists of multiple W5 app files, such as `feishu`, `firewalld`, and others. Each app includes `app.json` files and a `main` directory. For detailed information about the content of these apps, please refer to the [W5 SOAR official website](https://www.w5soar.com).

### Main Features
1. **Knowledge Graph Construction**  
   - Based on the dataset provided in the `data` directory, the project builds a comprehensive knowledge graph.
   - The graph construction process is primarily handled by the `build3` script. Before construction begins, existing graph data is cleared.
   - Entity data is organized into six text files within the `dict` directory, each containing specific entity names.

2. **Dependency Management**  
   - The `__pycache__` directory includes necessary libraries required to run the project.

3. **Script Functionality Overview**  
   - `monitor.py`: Monitors the directory for new JSON files (checked every 5 seconds). These files are typically generated by an intrusion detection system (IDS).
     - Extracts attack type and attack information from the JSON files.
     - Constructs query statements to retrieve specific configuration schemes from the knowledge graph.
   - `exchange.py`: Converts the exported configuration schemes into W5 scripts, which are used for automation orchestration.
   - `insert.py`: Completes the required parameters for W5 script execution.
     - Parameters available from the IDS are directly used.
     - Missing parameters are filled using a static dictionary, which maintains necessary information such as tokens and other configuration values.

### Workflow
1. Monitor new JSON files with `monitor.py`.
2. Extract attack information and query the knowledge graph for configuration schemes.
3. Pass the retrieved configuration to `exchange.py` to generate W5 scripts.
4. Use `insert.py` to complete any missing parameters and finalize the scripts.
5. The completed W5 scripts are ready for automated orchestration.

### Key Advantages
- Automates the generation of scripts for W5 orchestration.
- Dynamically updates parameters based on intrusion detection system output.
- Maintains a static dictionary for handling missing parameter information.

### Note
For more information on the structure and usage of `app.json` and the `main` directory, please visit the [W5 SOAR official documentation](https://www.w5soar.com).

